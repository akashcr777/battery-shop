{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\akash\\\\Downloads\\\\pilot-battery-shop-fullstack-mongodb\\\\pilot-battery-shop\\\\frontend\\\\src\\\\pages\\\\Products.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport api from \"../utils/api\";\nimport \"./Products.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Products = () => {\n  _s();\n  const {\n    category\n  } = useParams();\n  const navigate = useNavigate();\n  const [subCategory, setSubCategory] = useState(null);\n  const [products, setProducts] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const productNameToFilename = productName => {\n    return productName.toLowerCase().replace(/\\s+/g, \"-\").replace(/[()]/g, \"\").replace(/\\//g, \"-\").replace(/[^a-z0-9-]/g, \"\").replace(/-+/g, \"-\").replace(/^-|-$/g, \"\");\n  };\n  const [imageAttempts, setImageAttempts] = useState({});\n  const getImagePaths = product => {\n    const productFilename = productNameToFilename(product.name);\n    const subCat = product.subCategory;\n    const extensions = [\"jpg\", \"jpeg\", \"png\", \"webp\"];\n    const paths = [];\n\n    // Priority 1: exact product image\n    extensions.forEach(ext => {\n      paths.push(`/images/products/${productFilename}.${ext}`);\n    });\n\n    // Priority 2: category images (âœ… FIXED PATHS)\n    if (category === \"battery\") {\n      if (subCat === \"two-wheeler\") paths.push(\"/images/products/battery-two-wheeler.jpg\");else if (subCat === \"three-wheeler\") paths.push(\"/images/products/battery-three-wheeler.jpg\");else if (subCat === \"four-wheeler\") paths.push(\"/images/products/battery-four-wheeler.jpg\");else if (subCat === \"truck-series\") paths.push(\"/images/products/battery-truck.jpg\");else if (subCat === \"home\") paths.push(\"/images/products/battery-home.jpg\");\n    }\n    if (category === \"ups\") {\n      if (subCat === \"ups-type1\") paths.push(\"/images/ups-type1.jpg\");else if (subCat === \"ups-type2\") paths.push(\"/images/ups-type2.jpg\");else if (subCat === \"ups-type3\") paths.push(\"/images/ups-type3.jpg\");\n    }\n    return paths;\n  };\n  const getDefaultImage = product => {\n    if (product.image) return product.image;\n    const paths = getImagePaths(product);\n    const attempt = imageAttempts[product._id] || 0;\n    return paths[attempt] || paths[0];\n  };\n  const handleImageError = (product, e) => {\n    const productId = product._id;\n    const paths = getImagePaths(product);\n    const currentAttempt = imageAttempts[productId] || 0;\n    if (currentAttempt < paths.length - 1) {\n      setImageAttempts(prev => ({\n        ...prev,\n        [productId]: currentAttempt + 1\n      }));\n      e.target.src = paths[currentAttempt + 1];\n    }\n  };\n  useEffect(() => {\n    if (!subCategory) return;\n    const fetchProducts = async () => {\n      try {\n        setLoading(true);\n        const res = await api.get(\"/products\", {\n          params: {\n            category,\n            subCategory\n          }\n        });\n        setProducts(res.data);\n      } catch (err) {\n        console.error(err);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchProducts();\n  }, [category, subCategory]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"products-container\",\n    children: loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"loading\",\n      children: \"Loading products...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"products-grid\",\n      children: products.map(product => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"product-card\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-image-container\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: getDefaultImage(product),\n            alt: product.name,\n            className: \"product-image\",\n            onError: e => handleImageError(product, e)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 15\n        }, this)\n      }, product._id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 108,\n    columnNumber: 5\n  }, this);\n};\n_s(Products, \"2rj7oVYvKStUSWU7itQ4EFLYPVE=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = Products;\nexport default Products;\nvar _c;\n$RefreshReg$(_c, \"Products\");","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","api","jsxDEV","_jsxDEV","Products","_s","category","navigate","subCategory","setSubCategory","products","setProducts","loading","setLoading","productNameToFilename","productName","toLowerCase","replace","imageAttempts","setImageAttempts","getImagePaths","product","productFilename","name","subCat","extensions","paths","forEach","ext","push","getDefaultImage","image","attempt","_id","handleImageError","e","productId","currentAttempt","length","prev","target","src","fetchProducts","res","get","params","data","err","console","error","className","children","fileName","_jsxFileName","lineNumber","columnNumber","map","alt","onError","_c","$RefreshReg$"],"sources":["C:/Users/akash/Downloads/pilot-battery-shop-fullstack-mongodb/pilot-battery-shop/frontend/src/pages/Products.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useParams, useNavigate } from \"react-router-dom\";\r\nimport api from \"../utils/api\";\r\nimport \"./Products.css\";\r\n\r\nconst Products = () => {\r\n  const { category } = useParams();\r\n  const navigate = useNavigate();\r\n  const [subCategory, setSubCategory] = useState(null);\r\n  const [products, setProducts] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const productNameToFilename = (productName) => {\r\n    return productName\r\n      .toLowerCase()\r\n      .replace(/\\s+/g, \"-\")\r\n      .replace(/[()]/g, \"\")\r\n      .replace(/\\//g, \"-\")\r\n      .replace(/[^a-z0-9-]/g, \"\")\r\n      .replace(/-+/g, \"-\")\r\n      .replace(/^-|-$/g, \"\");\r\n  };\r\n\r\n  const [imageAttempts, setImageAttempts] = useState({});\r\n\r\n  const getImagePaths = (product) => {\r\n    const productFilename = productNameToFilename(product.name);\r\n    const subCat = product.subCategory;\r\n\r\n    const extensions = [\"jpg\", \"jpeg\", \"png\", \"webp\"];\r\n    const paths = [];\r\n\r\n    // Priority 1: exact product image\r\n    extensions.forEach((ext) => {\r\n      paths.push(`/images/products/${productFilename}.${ext}`);\r\n    });\r\n\r\n    // Priority 2: category images (âœ… FIXED PATHS)\r\n    if (category === \"battery\") {\r\n      if (subCat === \"two-wheeler\")\r\n        paths.push(\"/images/products/battery-two-wheeler.jpg\");\r\n      else if (subCat === \"three-wheeler\")\r\n        paths.push(\"/images/products/battery-three-wheeler.jpg\");\r\n      else if (subCat === \"four-wheeler\")\r\n        paths.push(\"/images/products/battery-four-wheeler.jpg\");\r\n      else if (subCat === \"truck-series\")\r\n        paths.push(\"/images/products/battery-truck.jpg\");\r\n      else if (subCat === \"home\")\r\n        paths.push(\"/images/products/battery-home.jpg\");\r\n    }\r\n\r\n    if (category === \"ups\") {\r\n      if (subCat === \"ups-type1\")\r\n        paths.push(\"/images/ups-type1.jpg\");\r\n      else if (subCat === \"ups-type2\")\r\n        paths.push(\"/images/ups-type2.jpg\");\r\n      else if (subCat === \"ups-type3\")\r\n        paths.push(\"/images/ups-type3.jpg\");\r\n    }\r\n\r\n    return paths;\r\n  };\r\n\r\n  const getDefaultImage = (product) => {\r\n    if (product.image) return product.image;\r\n\r\n    const paths = getImagePaths(product);\r\n    const attempt = imageAttempts[product._id] || 0;\r\n\r\n    return paths[attempt] || paths[0];\r\n  };\r\n\r\n  const handleImageError = (product, e) => {\r\n    const productId = product._id;\r\n    const paths = getImagePaths(product);\r\n    const currentAttempt = imageAttempts[productId] || 0;\r\n\r\n    if (currentAttempt < paths.length - 1) {\r\n      setImageAttempts((prev) => ({\r\n        ...prev,\r\n        [productId]: currentAttempt + 1,\r\n      }));\r\n      e.target.src = paths[currentAttempt + 1];\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (!subCategory) return;\r\n\r\n    const fetchProducts = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const res = await api.get(\"/products\", {\r\n          params: { category, subCategory },\r\n        });\r\n        setProducts(res.data);\r\n      } catch (err) {\r\n        console.error(err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchProducts();\r\n  }, [category, subCategory]);\r\n\r\n  return (\r\n    <div className=\"products-container\">\r\n      {loading ? (\r\n        <div className=\"loading\">Loading products...</div>\r\n      ) : (\r\n        <div className=\"products-grid\">\r\n          {products.map((product) => (\r\n            <div key={product._id} className=\"product-card\">\r\n              {/* ðŸ”¥ IMAGE ONLY FIX â€“ CARD DESIGN UNCHANGED */}\r\n              <div className=\"product-image-container\">\r\n                <img\r\n                  src={getDefaultImage(product)}\r\n                  alt={product.name}\r\n                  className=\"product-image\"\r\n                  onError={(e) => handleImageError(product, e)}\r\n                />\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Products;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}